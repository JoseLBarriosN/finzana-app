<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finzana - Sistema de Gestión de Créditos</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        .required {
            color: var(--danger);
            font-weight: bold;
        }

        .field-note {
            font-size: 12px;
            color: var(--gray);
            margin-top: 5px;
        }

        .search-group {
            display: flex;
            gap: 10px;
        }

            .search-group input {
                flex: 1;
            }
    </style>
</head>
<body>
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <p>Conectando con el servidor...</p>
    </div>

    <div id="login-screen" class="login-container hidden">
        <div class="login-box">
            <div class="login-logo"> <img src="assets/logo.png" alt="Logo de Finzana" style="width: 60px; height: auto;"></div>
            <h1>Bienvenido a Finzana</h1>
            <p>Sistema de gestión de créditos</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">Correo Electrónico</label>
                    <input type="email" id="email" placeholder="Ingresa tu correo" required value="barrios.nunez.joseluis@gmail.com">
                </div>
                <div class="form-group">
                    <label for="password">Contraseña</label>
                    <input type="password" id="password" placeholder="Ingresa tu contraseña" required>
                </div>
                <button type="submit" class="btn btn-primary"><i class="fas fa-sign-in-alt"></i> Iniciar Sesión</button>
            </form>
            <p id="auth-status" class="auth-status"></p>
        </div>
    </div>

    <div id="main-app" class="app-container hidden">
        <header class="app-header">
            <div class="user-info">
                <div class="user-avatar"><i class="fas fa-user"></i></div>
                <div>
                    <div id="user-name">Usuario Finzana</div>
                    <div id="user-role-display">Sistema de Créditos</div>
                </div>
            </div>
            <button id="logout-btn" class="btn btn-secondary"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</button>
        </header>

        <main class="app-content">
            <!-- Vista Principal - Menú -->
            <div id="view-main-menu" class="view">
                <h2>Panel de Control</h2>
                <div class="menu-grid">
                    <div class="menu-card" data-view="view-gestion-clientes">
                        <div class="menu-icon icon-clientes"><i class="fas fa-users"></i></div>
                        <h3>Gestión de Clientes</h3>
                        <p>Consulta y administra clientes</p>
                        <button class="btn btn-primary" data-view="view-gestion-clientes"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-usuarios">
                        <div class="menu-icon icon-usuarios"><i class="fas fa-user-cog"></i></div>
                        <h3>Gestión de Usuarios</h3>
                        <p>Administra usuarios y permisos</p>
                        <button class="btn btn-primary" data-view="view-usuarios"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-importar">
                        <div class="menu-icon icon-importar"><i class="fas fa-file-import"></i></div>
                        <h3>Importar Información</h3>
                        <p>Importa datos desde Excel</p>
                        <button class="btn btn-primary" data-view="view-importar"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-registrar">
                        <div class="menu-icon icon-registrar"><i class="fas fa-user-plus"></i></div>
                        <h3>Registrar Cliente</h3>
                        <p>Agregar nuevo cliente</p>
                        <button class="btn btn-primary" data-view="view-registrar"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-colocacion">
                        <div class="menu-icon icon-colocacion"><i class="fas fa-hand-holding-usd"></i></div>
                        <h3>Colocación</h3>
                        <p>Gestión de colocaciones</p>
                        <button class="btn btn-primary" data-view="view-colocacion"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-cobranza">
                        <div class="menu-icon icon-cobranza"><i class="fas fa-cash-register"></i></div>
                        <h3>Cobranza</h3>
                        <p>Gestión de cobranza</p>
                        <button class="btn btn-primary" data-view="view-cobranza"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-reportes">
                        <div class="menu-icon icon-reportes"><i class="fas fa-chart-bar"></i></div>
                        <h3>Reportes</h3>
                        <p>Reportes generales</p>
                        <button class="btn btn-primary" data-view="view-reportes"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                    <div class="menu-card" data-view="view-reportes-avanzados">
                        <div class="menu-icon icon-reportes-avanzados"><i class="fas fa-chart-line"></i></div>
                        <h3>Reportes Avanzados</h3>
                        <p>Reportes detallados</p>
                        <button class="btn btn-primary" data-view="view-reportes-avanzados"><i class="fas fa-arrow-right"></i> Acceder</button>
                    </div>
                </div>
            </div>

            <!-- Vista Gestión de Clientes -->
            <div id="view-gestion-clientes" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-users"></i> Gestión de Clientes</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <div class="filtros-container">
                    <h3>Filtros de Búsqueda</h3>
                    <div class="filtros-grid">
                        <div class="form-group">
                            <label for="filtro-nombre">Nombre</label>
                            <input type="text" id="filtro-nombre" placeholder="Buscar por nombre...">
                        </div>
                        <div class="form-group">
                            <label for="filtro-identificacion">Identificación</label>
                            <input type="text" id="filtro-identificacion" placeholder="Buscar por identificación...">
                        </div>
                        <div class="form-group">
                            <label for="filtro-estado">Estado del Crédito</label>
                            <select id="filtro-estado">
                                <option value="">Todos los estados</option>
                                <option value="Al Corriente">Al Corriente</option>
                                <option value="Atrasado">Atrasado</option>
                                <option value="Cobranza">Cobranza</option>
                                <option value="Jurídico">Jurídico</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filtro-cobrador">Cobrador</label>
                            <select id="filtro-cobrador">
                                <option value="">Todos los cobradores</option>
                            </select>
                        </div>
                    </div>
                    <div class="filtros-actions">
                        <button id="btn-filtrar-clientes" class="btn btn-primary"><i class="fas fa-filter"></i> Filtrar</button>
                        <button id="btn-limpiar-filtros-clientes" class="btn btn-secondary"><i class="fas fa-broom"></i> Limpiar Filtros</button>
                        <button id="btn-exportar-clientes" class="btn btn-success"><i class="fas fa-file-export"></i> Exportar a Excel</button>
                    </div>
                </div>
                <div id="status-message-clientes" class="status-message hidden"></div>
                <div class="table-responsive">
                    <table class="client-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Identificación</th>
                                <th>Teléfono</th>
                                <th>Estado Crédito</th>
                                <th>Cobrador</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-clientes-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 40px;">
                                    <i class="fas fa-search" style="font-size: 48px; color: #ddd; margin-bottom: 15px;"></i>
                                    <p>Utilice los filtros para buscar clientes</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Vista Gestión de Usuarios -->
            <div id="view-usuarios" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-user-cog"></i> Gestión de Usuarios</h2>
                    <div>
                        <button class="btn btn-primary" id="btn-nuevo-usuario"><i class="fas fa-user-plus"></i> Nuevo Usuario</button>
                        <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                    </div>
                </div>
                <div class="filtros-usuarios">
                    <h3>Filtros de Búsqueda</h3>
                    <div class="filtros-usuarios-grid">
                        <div class="form-group">
                            <label for="filtro-usuario-nombre">Nombre</label>
                            <input type="text" id="filtro-usuario-nombre" placeholder="Buscar por nombre...">
                        </div>
                        <div class="form-group">
                            <label for="filtro-usuario-email">Email</label>
                            <input type="text" id="filtro-usuario-email" placeholder="Buscar por email...">
                        </div>
                        <div class="form-group">
                            <label for="filtro-usuario-rol">Rol</label>
                            <select id="filtro-usuario-rol">
                                <option value="">Todos los roles</option>
                                <option value="admin">Administrador</option>
                                <option value="supervisor">Supervisor</option>
                                <option value="cobrador">Cobrador</option>
                                <option value="consulta">Consulta</option>
                            </select>
                        </div>
                    </div>
                    <div class="filtros-usuarios-actions">
                        <button id="btn-filtrar-usuarios" class="btn btn-primary"><i class="fas fa-filter"></i> Filtrar</button>
                        <button id="btn-limpiar-filtros-usuarios" class="btn btn-secondary"><i class="fas fa-broom"></i> Limpiar Filtros</button>
                        <button id="btn-cancelar-busqueda-usuarios" class="btn btn-danger"><i class="fas fa-times"></i> Cancelar Búsqueda</button>
                    </div>
                </div>
                <div id="status-message-usuarios" class="status-message hidden"></div>
                <div class="table-responsive">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Estado</th>
                                <th>Último Acceso</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-usuarios-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 40px;">
                                    <i class="fas fa-search" style="font-size: 48px; color: #ddd; margin-bottom: 15px;"></i>
                                    <p>Utilice los filtros para buscar usuarios</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Vista Importar Información -->
            <div id="view-importar" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-file-import"></i> Importar Información</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <div class="import-section">
                    <div class="import-tabs">
                        <div class="import-tab active" data-tab="clientes">Clientes</div>
                        <div class="import-tab" data-tab="creditos">Créditos</div>
                        <div class="import-tab" data-tab="pagos">Pagos</div>
                    </div>
                    <div class="import-tab-content">
                        <div id="tab-clientes" class="tab-content active">
                            <h4>Importar Clientes</h4>
                            <p>Selecciona un archivo Excel con los datos de clientes</p>
                            <div class="form-group">
                                <label for="archivo-clientes">Archivo Excel</label>
                                <input type="file" id="archivo-clientes" accept=".xlsx, .xls">
                            </div>
                            <button id="btn-importar-clientes" class="btn btn-primary"><i class="fas fa-upload"></i> Importar Clientes</button>
                        </div>
                        <div id="tab-creditos" class="tab-content hidden">
                            <h4>Importar Créditos</h4>
                            <p>Selecciona un archivo Excel con los datos de créditos</p>
                            <div class="form-group">
                                <label for="archivo-creditos">Archivo Excel</label>
                                <input type="file" id="archivo-creditos" accept=".xlsx, .xls">
                            </div>
                            <button id="btn-importar-creditos" class="btn btn-primary"><i class="fas fa-upload"></i> Importar Créditos</button>
                        </div>
                        <div id="tab-pagos" class="tab-content hidden">
                            <h4>Importar Pagos</h4>
                            <p>Selecciona un archivo Excel con los datos de pagos</p>
                            <div class="form-group">
                                <label for="archivo-pagos">Archivo Excel</label>
                                <input type="file" id="archivo-pagos" accept=".xlsx, .xls">
                            </div>
                            <button id="btn-importar-pagos" class="btn btn-primary"><i class="fas fa-upload"></i> Importar Pagos</button>
                        </div>
                    </div>
                </div>
                <div id="import-result" class="hidden"></div>
            </div>

            <!-- Vista Registrar Cliente -->
            <div id="view-registrar" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-user-plus"></i> Registrar Nuevo Cliente</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <form id="form-registrar-cliente">
                    <div class="filtros-grid">
                        <div class="form-group">
                            <label for="cliente-nombre">Nombre Completo <span class="required">*</span></label>
                            <input type="text" id="cliente-nombre" placeholder="Ingresa el nombre completo" required>
                        </div>
                        <div class="form-group">
                            <label for="cliente-identificacion">Identificación <span class="required">*</span></label>
                            <input type="text" id="cliente-identificacion" placeholder="Número de identificación" required>
                        </div>
                        <div class="form-group">
                            <label for="cliente-telefono">Teléfono</label>
                            <input type="tel" id="cliente-telefono" placeholder="Número de teléfono">
                        </div>
                        <div class="form-group">
                            <label for="cliente-email">Email</label>
                            <input type="email" id="cliente-email" placeholder="Correo electrónico">
                        </div>
                        <div class="form-group">
                            <label for="cliente-direccion">Dirección</label>
                            <textarea id="cliente-direccion" placeholder="Dirección completa" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="cliente-cobrador">Cobrador Asignado</label>
                            <select id="cliente-cobrador">
                                <option value="">Seleccionar cobrador</option>
                            </select>
                        </div>
                    </div>
                    <div class="filtros-actions">
                        <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> Registrar Cliente</button>
                        <button type="reset" class="btn btn-secondary"><i class="fas fa-undo"></i> Limpiar Formulario</button>
                    </div>
                </form>
                <div id="status-message-registrar" class="status-message hidden"></div>
            </div>

            <!-- Vista Colocación -->
            <div id="view-colocacion" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-hand-holding-usd"></i> Colocación de Créditos</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <div class="filtros-container">
                    <h3>Buscar Cliente para Colocación</h3>
                    <div class="search-group">
                        <input type="text" id="buscar-cliente-colocacion" placeholder="Ingresa nombre o identificación del cliente...">
                        <button id="btn-buscar-cliente-colocacion" class="btn btn-primary"><i class="fas fa-search"></i> Buscar</button>
                    </div>
                </div>
                <div id="resultado-busqueda-colocacion"></div>
                <div id="formulario-colocacion" class="hidden">
                    <h3>Datos del Crédito</h3>
                    <form id="form-colocacion">
                        <div class="filtros-grid">
                            <div class="form-group">
                                <label for="monto-credito">Monto del Crédito <span class="required">*</span></label>
                                <input type="number" id="monto-credito" placeholder="Monto del crédito" required step="0.01">
                            </div>
                            <div class="form-group">
                                <label for="plazo-credito">Plazo (meses) <span class="required">*</span></label>
                                <input type="number" id="plazo-credito" placeholder="Plazo en meses" required>
                            </div>
                            <div class="form-group">
                                <label for="tasa-interes">Tasa de Interés (%) <span class="required">*</span></label>
                                <input type="number" id="tasa-interes" placeholder="Tasa de interés" required step="0.01">
                            </div>
                            <div class="form-group">
                                <label for="fecha-desembolso">Fecha de Desembolso <span class="required">*</span></label>
                                <input type="date" id="fecha-desembolso" required>
                            </div>
                            <div class="form-group">
                                <label for="tipo-credito">Tipo de Crédito</label>
                                <select id="tipo-credito">
                                    <option value="Personal">Personal</option>
                                    <option value="Comercial">Comercial</option>
                                    <option value="Hipotecario">Hipotecario</option>
                                    <option value="Vehicular">Vehicular</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="garantia">Tipo de Garantía</label>
                                <select id="garantia">
                                    <option value="Personal">Personal</option>
                                    <option value="Prendaria">Prendaria</option>
                                    <option value="Hipotecaria">Hipotecaria</option>
                                    <option value="Mixta">Mixta</option>
                                </select>
                            </div>
                        </div>
                        <div class="filtros-actions">
                            <button type="submit" class="btn btn-success"><i class="fas fa-check"></i> Aprobar Crédito</button>
                            <button type="button" id="btn-cancelar-colocacion" class="btn btn-secondary"><i class="fas fa-times"></i> Cancelar</button>
                        </div>
                    </form>
                </div>
                <div id="status-message-colocacion" class="status-message hidden"></div>
            </div>

            <!-- Vista Cobranza -->
            <div id="view-cobranza" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-cash-register"></i> Gestión de Cobranza</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <div class="filtros-container">
                    <h3>Filtros de Cobranza</h3>
                    <div class="filtros-grid">
                        <div class="form-group">
                            <label for="filtro-cobranza-estado">Estado</label>
                            <select id="filtro-cobranza-estado">
                                <option value="">Todos los estados</option>
                                <option value="Atrasado">Atrasado</option>
                                <option value="Cobranza">Cobranza</option>
                                <option value="Jurídico">Jurídico</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filtro-cobranza-cobrador">Cobrador</label>
                            <select id="filtro-cobranza-cobrador">
                                <option value="">Todos los cobradores</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filtro-cobranza-fecha">Días de Atraso</label>
                            <select id="filtro-cobranza-fecha">
                                <option value="">Todos</option>
                                <option value="1-7">1-7 días</option>
                                <option value="8-30">8-30 días</option>
                                <option value="31-90">31-90 días</option>
                                <option value="91+">Más de 90 días</option>
                            </select>
                        </div>
                    </div>
                    <div class="filtros-actions">
                        <button id="btn-filtrar-cobranza" class="btn btn-primary"><i class="fas fa-filter"></i> Filtrar</button>
                        <button id="btn-exportar-cobranza" class="btn btn-success"><i class="fas fa-file-export"></i> Exportar</button>
                    </div>
                </div>
                <div id="status-message-cobranza" class="status-message hidden"></div>
                <div class="table-responsive">
                    <table class="client-table">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Identificación</th>
                                <th>Teléfono</th>
                                <th>Estado</th>
                                <th>Días Atraso</th>
                                <th>Saldo Pendiente</th>
                                <th>Cobrador</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-cobranza-body">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px;">
                                    <i class="fas fa-search" style="font-size: 48px; color: #ddd; margin-bottom: 15px;"></i>
                                    <p>Utilice los filtros para buscar registros de cobranza</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Vista Reportes -->
            <div id="view-reportes" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-chart-bar"></i> Reportes Generales</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <div class="report-grid">
                    <div class="report-card">
                        <div class="report-icon"><i class="fas fa-users"></i></div>
                        <div class="report-value" id="total-clientes">0</div>
                        <div class="report-label">Total Clientes</div>
                    </div>
                    <div class="report-card">
                        <div class="report-icon"><i class="fas fa-hand-holding-usd"></i></div>
                        <div class="report-value" id="total-creditos">0</div>
                        <div class="report-label">Créditos Activos</div>
                    </div>
                    <div class="report-card">
                        <div class="report-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="report-value" id="cartera-total">$0</div>
                        <div class="report-label">Cartera Total</div>
                    </div>
                    <div class="report-card">
                        <div class="report-icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="report-value" id="creditos-atrasados">0</div>
                        <div class="report-label">Créditos Atrasados</div>
                    </div>
                </div>
                <div class="export-buttons">
                    <button id="btn-exportar-reporte-general" class="btn btn-success"><i class="fas fa-file-excel"></i> Exportar Reporte General</button>
                    <button id="btn-exportar-cartera" class="btn btn-info"><i class="fas fa-file-pdf"></i> Exportar Cartera PDF</button>
                </div>
                <div class="filtros-container">
                    <h3>Reporte Detallado</h3>
                    <div class="filtros-grid">
                        <div class="form-group">
                            <label for="reporte-tipo">Tipo de Reporte</label>
                            <select id="reporte-tipo">
                                <option value="estado-creditos">Estado de Créditos</option>
                                <option value="cobradores">Desempeño por Cobrador</option>
                                <option value="colocacion-mensual">Colocación Mensual</option>
                                <option value="cobranza-mensual">Cobranza Mensual</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reporte-fecha-inicio">Fecha Inicio</label>
                            <input type="date" id="reporte-fecha-inicio">
                        </div>
                        <div class="form-group">
                            <label for="reporte-fecha-fin">Fecha Fin</label>
                            <input type="date" id="reporte-fecha-fin">
                        </div>
                    </div>
                    <div class="filtros-actions">
                        <button id="btn-generar-reporte" class="btn btn-primary"><i class="fas fa-chart-bar"></i> Generar Reporte</button>
                    </div>
                </div>
                <div id="resultado-reporte"></div>
            </div>

            <!-- Vista Reportes Avanzados -->
            <div id="view-reportes-avanzados" class="view hidden">
                <div class="view-header">
                    <h2><i class="fas fa-chart-line"></i> Reportes Avanzados</h2>
                    <button class="btn btn-secondary" data-view="view-main-menu"><i class="fas fa-arrow-left"></i> Volver al Menú</button>
                </div>
                <div class="advanced-filters">
                    <div class="filter-section">
                        <div class="filter-section-title">Filtros Avanzados</div>
                        <div class="filtros-grid">
                            <div class="form-group">
                                <label for="avanzado-fecha-inicio">Fecha Inicio</label>
                                <input type="date" id="avanzado-fecha-inicio">
                            </div>
                            <div class="form-group">
                                <label for="avanzado-fecha-fin">Fecha Fin</label>
                                <input type="date" id="avanzado-fecha-fin">
                            </div>
                            <div class="form-group">
                                <label for="avanzado-cobrador">Cobrador</label>
                                <select id="avanzado-cobrador">
                                    <option value="">Todos los cobradores</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="avanzado-estado">Estado</label>
                                <select id="avanzado-estado">
                                    <option value="">Todos los estados</option>
                                    <option value="Al Corriente">Al Corriente</option>
                                    <option value="Atrasado">Atrasado</option>
                                    <option value="Cobranza">Cobranza</option>
                                    <option value="Jurídico">Jurídico</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="filter-section">
                        <div class="filter-section-title">Tipo de Análisis</div>
                        <div class="filtros-grid">
                            <div class="form-group">
                                <label for="avanzado-tipo-analisis">Análisis</label>
                                <select id="avanzado-tipo-analisis">
                                    <option value="comportamiento-pagos">Comportamiento de Pagos</option>
                                    <option value="eficiencia-cobradores">Eficiencia de Cobradores</option>
                                    <option value="concentracion-cartera">Concentración de Cartera</option>
                                    <option value="proyeccion-cobranza">Proyección de Cobranza</option>
                                    <option value="analisis-riesgo">Análisis de Riesgo</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="avanzado-metrica">Métrica Principal</label>
                                <select id="avanzado-metrica">
                                    <option value="monto">Monto</option>
                                    <option value="cantidad">Cantidad</option>
                                    <option value="porcentaje">Porcentaje</option>
                                    <option value="tendencia">Tendencia</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="filtros-actions">
                        <button id="btn-generar-reporte-avanzado" class="btn btn-primary"><i class="fas fa-chart-line"></i> Generar Reporte Avanzado</button>
                        <button id="btn-exportar-reporte-avanzado" class="btn btn-success"><i class="fas fa-file-export"></i> Exportar a Excel</button>
                    </div>
                </div>
                <div id="resultado-reporte-avanzado"></div>
            </div>
        </main>
    </div>

    <!-- Modal para Nuevo Usuario -->
    <div id="modal-nuevo-usuario" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Nuevo Usuario</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-nuevo-usuario">
                    <div class="form-group">
                        <label for="nuevo-usuario-nombre">Nombre Completo <span class="required">*</span></label>
                        <input type="text" id="nuevo-usuario-nombre" placeholder="Ingresa el nombre completo" required>
                    </div>
                    <div class="form-group">
                        <label for="nuevo-usuario-email">Correo Electrónico <span class="required">*</span></label>
                        <input type="email" id="nuevo-usuario-email" placeholder="Ingresa el correo electrónico" required>
                    </div>
                    <div class="form-group">
                        <label for="nuevo-usuario-password">Contraseña <span class="required">*</span></label>
                        <input type="password" id="nuevo-usuario-password" placeholder="Ingresa la contraseña" required>
                        <div class="field-note">Mínimo 6 caracteres</div>
                    </div>
                    <div class="form-group">
                        <label for="nuevo-usuario-rol">Rol <span class="required">*</span></label>
                        <select id="nuevo-usuario-rol" required>
                            <option value="">Seleccionar rol</option>
                            <option value="admin">Administrador</option>
                            <option value="supervisor">Supervisor</option>
                            <option value="cobrador">Cobrador</option>
                            <option value="consulta">Consulta</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nuevo-usuario-activo">Estado</label>
                        <select id="nuevo-usuario-activo">
                            <option value="true">Activo</option>
                            <option value="false">Inactivo</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> Crear Usuario</button>
                        <button type="button" class="btn btn-secondary modal-close"><i class="fas fa-times"></i> Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Usuario -->
    <div id="modal-editar-usuario" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-edit"></i> Editar Usuario</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-editar-usuario">
                    <input type="hidden" id="editar-usuario-id">
                    <div class="form-group">
                        <label for="editar-usuario-nombre">Nombre Completo <span class="required">*</span></label>
                        <input type="text" id="editar-usuario-nombre" placeholder="Ingresa el nombre completo" required>
                    </div>
                    <div class="form-group">
                        <label for="editar-usuario-email">Correo Electrónico <span class="required">*</span></label>
                        <input type="email" id="editar-usuario-email" placeholder="Ingresa el correo electrónico" required>
                    </div>
                    <div class="form-group">
                        <label for="editar-usuario-password">Nueva Contraseña</label>
                        <input type="password" id="editar-usuario-password" placeholder="Dejar vacío para mantener la actual">
                        <div class="field-note">Mínimo 6 caracteres</div>
                    </div>
                    <div class="form-group">
                        <label for="editar-usuario-rol">Rol <span class="required">*</span></label>
                        <select id="editar-usuario-rol" required>
                            <option value="">Seleccionar rol</option>
                            <option value="admin">Administrador</option>
                            <option value="supervisor">Supervisor</option>
                            <option value="cobrador">Cobrador</option>
                            <option value="consulta">Consulta</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editar-usuario-activo">Estado</label>
                        <select id="editar-usuario-activo">
                            <option value="true">Activo</option>
                            <option value="false">Inactivo</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> Guardar Cambios</button>
                        <button type="button" class="btn btn-secondary modal-close"><i class="fas fa-times"></i> Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Confirmar Eliminación -->
    <div id="modal-confirmar-eliminar" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Confirmar Eliminación</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmar-eliminar-mensaje">¿Estás seguro de que deseas eliminar este registro?</p>
                <div class="form-actions">
                    <button id="btn-confirmar-eliminar" class="btn btn-danger"><i class="fas fa-trash"></i> Eliminar</button>
                    <button type="button" class="btn btn-secondary modal-close"><i class="fas fa-times"></i> Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Barra de Progreso Mejorada - FIJADA EN PARTE SUPERIOR -->
    <div id="progress-container" class="progress-container-fixed hidden">
        <div class="progress-text-fixed" id="progress-text">Procesando...</div>
        <div class="progress-bar-fixed" id="progress-bar"></div>
        <button class="btn-cancelar-carga-fixed" id="btn-cancelar-carga" title="Cancelar operación">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Overlay de procesamiento -->
    <div id="processing-overlay" class="processing-overlay hidden">
        <div class="processing-spinner"></div>
        <div class="processing-message" id="processing-message">Procesando...</div>
    </div>

    <!-- Scripts de Firebase y configuración -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script>
        // Configuración de Firebase - INTEGRADA DESDE TU CÓDIGO ORIGINAL
        const firebaseConfig = {
            apiKey: "AIzaSyBNt_JKONVgOXS4fgJrj3qldb1JBdOgPoE",
            authDomain: "finzana-app.firebaseapp.com",
            projectId: "finzana-app",
            storageBucket: "finzana-app.firebasestorage.app",
            messagingSenderId: "779745085151",
            appId: "1:779745085151:web:2d470408b6267e3e16cb6a"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
    </script>
    
    <script src="js/app.js"></script>
</body>
</html>
